{"remainingRequest":"D:\\porject\\vue02\\testcli3.01\\mall\\node_modules\\babel-loader\\lib\\index.js!D:\\porject\\vue02\\testcli3.01\\mall\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\porject\\vue02\\testcli3.01\\mall\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\porject\\vue02\\testcli3.01\\mall\\src\\views\\home\\Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\porject\\vue02\\testcli3.01\\mall\\src\\views\\home\\Home.vue","mtime":1616636942826},{"path":"D:\\porject\\vue02\\testcli3.01\\mall\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\porject\\vue02\\testcli3.01\\mall\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\porject\\vue02\\testcli3.01\\mall\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\porject\\vue02\\testcli3.01\\mall\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _toConsumableArray from \"D:/porject/vue02/testcli3.01/mall/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport NavBar from 'components/common/navBar/NavBar';\nimport Tabs from 'components/centent/tabs/Tabs';\nimport GoodsList from 'components/centent/goods/GoodsList';\nimport Scroll from 'components/common/scroll/Scroll';\nimport BackTop from 'components/centent/backtop/BackTop';\nimport HomeSwiper from \"./childComp/HomeSwiper\";\nimport HomeRecommend from \"./childComp/HomeRecommend\";\nimport HomeFeature from \"./childComp/HomeFeature\";\nimport { homeBannerData, homeGoodsData } from 'network/home';\nimport { debounce } from 'common/utils';\nexport default {\n  name: 'Home',\n  components: {\n    NavBar: NavBar,\n    Tabs: Tabs,\n    GoodsList: GoodsList,\n    Scroll: Scroll,\n    BackTop: BackTop,\n    HomeSwiper: HomeSwiper,\n    HomeFeature: HomeFeature,\n    HomeRecommend: HomeRecommend,\n    homeGoodsData: homeGoodsData\n  },\n  data: function data() {\n    return {\n      bannerList: [],\n      recommend: [],\n      goods: {\n        'pop': {\n          page: 0,\n          list: []\n        },\n        'new': {\n          page: 0,\n          list: []\n        },\n        'sell': {\n          page: 0,\n          list: []\n        }\n      },\n      currentType: 'pop',\n      isShowBackTop: false,\n      tabOffsetTop: 0,\n      isTabFixed: false,\n      saveY: 0,\n      itemImgListener: null\n    };\n  },\n  computed: {\n    showGoods: function showGoods() {\n      return this.goods[this.currentType].list;\n    }\n  },\n  created: function created() {\n    this.getHomeBannerData();\n    this.getHomeGoodsData('pop');\n    this.getHomeGoodsData('new');\n    this.getHomeGoodsData('sell');\n  },\n  methods: {\n    getHomeBannerData: function getHomeBannerData() {\n      var _this = this;\n\n      homeBannerData().then(function (res) {\n        _this.bannerList = res.data.banner.list;\n        _this.recommend = res.data.recommend.list;\n      });\n    },\n    getHomeGoodsData: function getHomeGoodsData(type) {\n      var _this2 = this;\n\n      var page = this.goods[type].page + 1;\n      homeGoodsData(type, page).then(function (res) {\n        var _this2$goods$type$lis;\n\n        // 把取到的数据存在goods中\n        (_this2$goods$type$lis = _this2.goods[type].list).push.apply(_this2$goods$type$lis, _toConsumableArray(res.data.list)); // 当前页数+1\n\n\n        _this2.goods[type].page += 1; // 以完成了加载更多数据 初始化 pullup\n\n        _this2.$refs.scroll.finishPullUp();\n      });\n    },\n    swiperImgLoad: function swiperImgLoad() {\n      // 吸顶效果\n      // 所有的组件都有一个属性$el\n      // this.$refs.tabControl.$el.offsetTop\n      this.tabOffsetTop = this.$refs.tabControl2.$el.offsetTop;\n    },\n\n    /**\r\n     * 事件\r\n     */\n    contentScroll: function contentScroll(position) {\n      // 拿到页面滚动的位置 是否显示backtop图标\n      this.isShowBackTop = -position.y > 500; //\n\n      this.isTabFixed = -position.y > this.tabOffsetTop;\n    },\n    // 返回顶部\n    backClick: function backClick() {\n      this.$refs.scroll.scrollTo(0, 0);\n    },\n    tabsClick: function tabsClick(index) {\n      switch (index) {\n        case 0:\n          this.currentType = 'pop';\n          break;\n\n        case 1:\n          this.currentType = 'new';\n          break;\n\n        case 2:\n          this.currentType = 'sell';\n          break;\n      }\n\n      this.$refs.tabControl1.activeIndex = index;\n      this.$refs.tabControl2.activeIndex = index;\n    },\n    // 下来加载更多数据\n    loadMore: function loadMore() {\n      this.getHomeGoodsData(this.currentType);\n    }\n  },\n  mounted: function mounted() {\n    this.itemImgListener = function () {\n      // 防抖函数 \n      refresh();\n    }; // 监听图片加载完成\n\n\n    var refresh = debounce(this.$refs.scroll.refresh, 500);\n    this.$bus.$on('itemImgLoad', this.itemImgListener);\n  },\n  // 活跃\n  activated: function activated() {\n    this.$refs.scroll.scrollTo(0, this.saveY, 0);\n    this.$refs.scroll.refresh();\n  },\n  // 离开\n  deactivated: function deactivated() {\n    // 拿到用户离开当前页面时当前页面滚动的距离\n    this.saveY = this.$refs.scroll.getScrollY(); // 取消全局事件的监听\n\n    this.$bus.$off('itemImgLoad', this.itemImgListener);\n  }\n};",{"version":3,"sources":["Home.vue"],"names":[],"mappings":"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","sourcesContent":["<template lang=\"\">\r\n  <div id=\"home\">\r\n    <nav-bar class=\"home-nav\"><div slot=\"center\">购物街</div></nav-bar>\r\n    <tabs class=\"tab-control\" \r\n          :titles=\"['流行','时尚','精选']\" \r\n          @tabsClick=\"tabsClick\" \r\n          ref=\"tabControl1\" \r\n          v-show=\"isTabFixed\"/>\r\n    <scroll class=\"content\" \r\n            ref=\"scroll\" \r\n            :probe-type=\"3\" \r\n            :pull-up-load=\"true\"\r\n            @scroll=\"contentScroll\"\r\n            @pullingUp=\"loadMore\" >\r\n      <home-swiper :bannerList=\"bannerList\" @swiperImgLoad=\"swiperImgLoad\" />\r\n      <home-recommend :recommend=\"recommend\" />\r\n      <home-feature />\r\n      <tabs :titles=\"['流行','时尚','精选']\" \r\n            @tabsClick=\"tabsClick\" \r\n            ref=\"tabControl2\" />\r\n      <goods-list :goods=\"showGoods\" />\r\n    </scroll>\r\n    <!-- 组件点击事件需要添加事件修饰符 -->\r\n    <back-top @click.native=\"backClick\" v-show=\"isShowBackTop\" />\r\n  </div>\r\n</template>\r\n<script>\r\nimport NavBar from 'components/common/navBar/NavBar'\r\nimport Tabs from 'components/centent/tabs/Tabs'\r\nimport GoodsList from 'components/centent/goods/GoodsList'\r\nimport Scroll from 'components/common/scroll/Scroll'\r\nimport BackTop from 'components/centent/backtop/BackTop'\r\n\r\nimport HomeSwiper from './childComp/HomeSwiper'\r\nimport HomeRecommend from './childComp/HomeRecommend'\r\nimport HomeFeature from './childComp/HomeFeature'\r\n\r\nimport {homeBannerData, homeGoodsData} from 'network/home'\r\nimport {debounce} from 'common/utils'\r\n\r\nexport default {\r\n  name: 'Home',\r\n  components: {\r\n    NavBar,\r\n    Tabs,\r\n    GoodsList,\r\n    Scroll,\r\n    BackTop,\r\n    HomeSwiper,\r\n    HomeFeature,\r\n    HomeRecommend,\r\n    homeGoodsData\r\n  },\r\n  data() {\r\n    return {\r\n      bannerList: [],\r\n      recommend: [],\r\n      goods: {\r\n        'pop':{page: 0, list: []},\r\n        'new':{page: 0, list: []},\r\n        'sell':{page: 0, list: []}\r\n      },\r\n      currentType: 'pop',\r\n      isShowBackTop: false,\r\n      tabOffsetTop: 0,\r\n      isTabFixed: false,\r\n      saveY: 0,\r\n      itemImgListener: null\r\n    }\r\n  },\r\n  computed: {\r\n    showGoods() {\r\n      return this.goods[this.currentType].list\r\n    }\r\n  },\r\n  created() {\r\n    this.getHomeBannerData();\r\n    this.getHomeGoodsData('pop');\r\n    this.getHomeGoodsData('new');\r\n    this.getHomeGoodsData('sell');\r\n  },\r\n  methods: {\r\n    getHomeBannerData() {\r\n      homeBannerData().then(res => {\r\n        this.bannerList = res.data.banner.list;\r\n        this.recommend = res.data.recommend.list\r\n      })\r\n    },\r\n    getHomeGoodsData(type) {\r\n      const page = this.goods[type].page + 1;\r\n      homeGoodsData(type, page).then(res => {\r\n        // 把取到的数据存在goods中\r\n        this.goods[type].list.push(...res.data.list)\r\n        // 当前页数+1\r\n        this.goods[type].page += 1;\r\n        // 以完成了加载更多数据 初始化 pullup\r\n        this.$refs.scroll.finishPullUp()\r\n      })\r\n    },\r\n    swiperImgLoad() {\r\n      // 吸顶效果\r\n      // 所有的组件都有一个属性$el\r\n      // this.$refs.tabControl.$el.offsetTop\r\n      this.tabOffsetTop = this.$refs.tabControl2.$el.offsetTop;\r\n    },\r\n    /**\r\n     * 事件\r\n     */\r\n    contentScroll(position) {\r\n      // 拿到页面滚动的位置 是否显示backtop图标\r\n      this.isShowBackTop = -(position.y) > 500\r\n      //\r\n      this.isTabFixed = -(position.y) > this.tabOffsetTop\r\n    },\r\n    // 返回顶部\r\n    backClick() {\r\n      this.$refs.scroll.scrollTo(0, 0);\r\n    },\r\n    tabsClick(index) {\r\n      switch (index) {\r\n        case 0:\r\n          this.currentType = 'pop'\r\n          break;\r\n        case 1:\r\n          this.currentType = 'new'\r\n          break;\r\n        case 2:\r\n          this.currentType = 'sell'\r\n          break;\r\n      }\r\n      this.$refs.tabControl1.activeIndex = index;\r\n      this.$refs.tabControl2.activeIndex = index;\r\n    },\r\n    // 下来加载更多数据\r\n    loadMore() {\r\n      this.getHomeGoodsData(this.currentType)\r\n    },\r\n  },\r\n  mounted() {\r\n    this.itemImgListener = () => {\r\n      // 防抖函数 \r\n      refresh();\r\n    }\r\n    // 监听图片加载完成\r\n    const refresh = debounce(this.$refs.scroll.refresh, 500);\r\n    this.$bus.$on('itemImgLoad', this.itemImgListener)\r\n    \r\n  },\r\n  // 活跃\r\n  activated() {\r\n    this.$refs.scroll.scrollTo(0, this.saveY, 0);\r\n    this.$refs.scroll.refresh();\r\n  },\r\n  // 离开\r\n  deactivated() {\r\n    // 拿到用户离开当前页面时当前页面滚动的距离\r\n    this.saveY = this.$refs.scroll.getScrollY()\r\n    // 取消全局事件的监听\r\n    this.$bus.$off('itemImgLoad', this.itemImgListener)\r\n  },\r\n}\r\n</script>\r\n<style scoped>\r\n  #home {\r\n    height: 100vh;\r\n    position: relative;\r\n  }\r\n  .home-nav {\r\n    background-color: var(--color-tint);\r\n    color: #fff;\r\n    /* 在使用浏览器原生滚动时为了让导航不跟随一起滚动 */\r\n    /*position: fixed;\r\n    left: 0;\r\n    top: 0;\r\n    right: 0;\r\n    z-index: 9; */\r\n  }\r\n  .content {\r\n    overflow: hidden;\r\n    position: absolute;\r\n    top: 44px;\r\n    bottom: 49px;\r\n    left: 0;\r\n    right: 0;\r\n  }\r\n  .tab-control {\r\n    position: relative;\r\n    z-index: 9;\r\n  }\r\n</style>"],"sourceRoot":"src/views/home"}]}